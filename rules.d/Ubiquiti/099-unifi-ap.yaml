rewrite_rules:
- comment:
  - Fix unifi AP hostnames
  - Someone should really get Ubiquiti to fix their syslog header
  match:
    field: host
    op: =~
    value: \(.([^,]+),([[:alnum:]]{6}([[:alnum:]]{6})),v(\d+\.\d+\.\d+\.\d+).+\)
  rewrite:
    host: $3
    program: Unifi-AP
  tag:
    Ubiquiti MAC IDs: $2$3
    Ubiquiti AP Types: $1
    Ubiquiti AP Versions: $4
- comment: Extract Leave/Joins
  match:
    field: message
    op: =~
    value: .+UBNT-STA-(\S+) eth\d+.\d+\(([^\)]+)\)
  tag:
    Ubiquiti Client Leave/Join MACs: $1->$2
    Ubiquiti Client Leave/Joins: $1
    Ubiquiti Client MACs: $2
