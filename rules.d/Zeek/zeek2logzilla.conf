# This is for your *relay* server (not the LogZilla server)
# filename: /etc/syslog-ng/conf.d/zeek2logzilla.conf
#
# Global Options
options {
  flush_lines(100);
  threaded(yes);
  use_dns(yes);
  use_fqdn (no);
  keep_hostname (yes);
  dns-cache-size(2000);
  dns-cache-expire(87600);
};

# Filter out comments in bro logs
filter f_not_comment { not message("^#"); };

# Define log sources
source s_bro_conn { file("/usr/local/zeek/logs/current/conn.log" flags(no-parse) program_override("bro_conn")); };
source s_bro_dce_rpc { file("/usr/local/zeek/logs/current/dce_rpc.log" flags(no-parse) program_override("bro_dce_rpc")); };
source s_bro_dhcp { file("/usr/local/zeek/logs/current/dhcp.log" flags(no-parse) program_override("bro_dhcp")); };
source s_bro_dnp3 { file("/usr/local/zeek/logs/current/dnp3.log" flags(no-parse) program_override("bro_dnp3")); };
source s_bro_dns { file("/usr/local/zeek/logs/current/dns.log" flags(no-parse) program_override("bro_dns")); };
source s_bro_files { file("/usr/local/zeek/logs/current/files.log" flags(no-parse) program_override("bro_files")); };
source s_bro_ftp { file("/usr/local/zeek/logs/current/ftp.log" flags(no-parse) program_override("bro_ftp")); };
source s_bro_http { file("/usr/local/zeek/logs/current/http.log" flags(no-parse) program_override("bro_http")); };
source s_bro_intel { file("/usr/local/zeek/logs/current/intel.log" flags(no-parse) program_override("bro_intel")); };
source s_bro_irc { file("/usr/local/zeek/logs/current/irc.log" flags(no-parse) program_override("bro_irc")); };
source s_bro_kerberos { file("/usr/local/zeek/logs/current/kerberos.log" flags(no-parse) program_override("bro_kerberos")); };
source s_bro_modbus { file("/usr/local/zeek/logs/current/modbus.log" flags(no-parse) program_override("bro_modbus")); };
source s_bro_mysql { file("/usr/local/zeek/logs/current/mysql.log" flags(no-parse) program_override("bro_mysql")); };
source s_bro_notice { file("/usr/local/zeek/logs/current/notice.log" flags(no-parse) program_override("bro_notice")); };
source s_bro_ntlm { file("/usr/local/zeek/logs/current/ntlm.log" flags(no-parse) program_override("bro_ntlm")); };
source s_bro_pe { file("/usr/local/zeek/logs/current/pe.log" flags(no-parse) program_override("bro_pe")); };
source s_bro_radius { file("/usr/local/zeek/logs/current/radius.log" flags(no-parse) program_override("bro_radius")); };
source s_bro_rdp { file("/usr/local/zeek/logs/current/rdp.log" flags(no-parse) program_override("bro_rdp")); };
source s_bro_rfb { file("/usr/local/zeek/logs/current/rfb.log" flags(no-parse) program_override("bro_rfb")); };
source s_bro_sip { file("/usr/local/zeek/logs/current/sip.log" flags(no-parse) program_override("bro_sip")); };
source s_bro_smb_files { file("/usr/local/zeek/logs/current/smb_files.log" flags(no-parse) program_override("bro_smb_files")); };
source s_bro_smb_mapping { file("/usr/local/zeek/logs/current/smb_mapping.log" flags(no-parse) program_override("bro_smb_mapping")); };
source s_bro_smtp { file("/usr/local/zeek/logs/current/smtp.log" flags(no-parse) program_override("bro_smtp")); };
source s_bro_smtp_entities { file("/usr/local/zeek/logs/current/smtp_entities.log" flags(no-parse) program_override("bro_smtp_entities")); };
source s_bro_snmp { file("/usr/local/zeek/logs/current/snmp.log" flags(no-parse) program_override("bro_snmp")); };
source s_bro_software { file("/usr/local/zeek/logs/current/software.log" flags(no-parse) program_override("bro_software")); };
source s_bro_ssh { file("/usr/local/zeek/logs/current/ssh.log" flags(no-parse) program_override("bro_ssh")); };
source s_bro_ssl { file("/usr/local/zeek/logs/current/ssl.log" flags(no-parse) program_override("bro_ssl")); };
source s_bro_syslog { file("/usr/local/zeek/logs/current/syslog.log" flags(no-parse) program_override("bro_syslog")); };
source s_bro_tunnels { file("/usr/local/zeek/logs/current/tunnel.log" flags(no-parse) program_override("bro_tunnels")); };
source s_bro_weird { file("/usr/local/zeek/logs/current/weird.log" flags(no-parse) program_override("bro_weird")); };
source s_bro_x509 { file("/usr/local/zeek/logs/current/x509.log" flags(no-parse) program_override("bro_x509")); };

# Set destination (logzilla)
destination d_logzilla { tcp("10.20.200.14" port(514)); };

# Send all sources to logzilla destination
log {
  source(s_bro_conn);
  source(s_bro_dce_rpc);
  source(s_bro_dhcp);
  source(s_bro_dnp3);
  source(s_bro_dns);
  source(s_bro_files);
  source(s_bro_ftp);
  source(s_bro_http);
  source(s_bro_intel);
  source(s_bro_irc);
  source(s_bro_kerberos);
  source(s_bro_modbus);
  source(s_bro_mysql);
  source(s_bro_notice);
  source(s_bro_ntlm);
  source(s_bro_pe);
  source(s_bro_radius);
  source(s_bro_rdp);
  source(s_bro_rfb);
  source(s_bro_sip);
  source(s_bro_smb_files);
  source(s_bro_smb_mapping);
  source(s_bro_smtp);
  source(s_bro_smtp_entities);
  source(s_bro_snmp);
  source(s_bro_software);
  source(s_bro_ssh);
  source(s_bro_ssl);
  source(s_bro_syslog);
  source(s_bro_tunnels);
  source(s_bro_weird);
  source(s_bro_x509);
  filter(f_not_comment);
  destination(d_logzilla);
  flags(flow-control);
};
