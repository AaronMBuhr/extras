first_match_only: true
rewrite_rules:
- comment:
  - 'FortiGate: Traffic Logs > Forward Traffic'
  - 'Sample Log:'
  - 'date=2019-05-10 time=11:37:47 logid="0000000013" type="traffic" subtype="forward" level="notice" vd="vdom1" eventtime=1557513467369913239 srcip=10.1.100.11 srcport=58012 srcintf="port12" srcintfrole="undefined" dstip=23.59.154.35 dstport=80 dstintf="port11" dstintfrole="undefined" srcuuid="ae28f494-5735-51e9-f247-d1d2ce663f4b" dstuuid="ae28f494-5735-51e9-f247-d1d2ce663f4b" poluuid="ccb269e0-5735-51e9-a218-a397dd08b7eb" sessionid=105048 proto=6 action="close" policyid=1 policytype="policy" service="HTTP" dstcountry="Canada" srccountry="Reserved" trandisp="snat" transip=172.16.200.2 transport=58012 appid=34050 app="HTTP.BROWSER_Firefox" appcat="Web.Client" apprisk="elevated" applist="g-default" duration=116 sentbyte=1188 rcvdbyte=1224 sentpkt=17 rcvdpkt=16 utmaction="allow" countapp=1 osname="Ubuntu" mastersrcmac="a2:e9:00:ec:40:01" srcmac="a2:e9:00:ec:40:01" srcserver=0 utmref=65500-742'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0000
  rewrite:
    program: FortiGate Forward Traffic
  tag:
    Fortigate Forwarding Types: ${type}
    Fortigate Forwarding SubTypes: ${subtype}
    Fortigate Forwarding Source Interfaces: ${srcintf}
    Fortigate Forwarding Source Interface Roles: ${srcintfrole}
    Fortigate Forwarding Destination Interfaces: ${dstintf}
    Fortigate Forwarding Destination Interface Roles: ${dstintfrole}
    Fortigate Forwarding Services: ${service}
    Fortigate Forwarding Destination Countries: ${dstcountry}
    Fortigate Forwarding Applications: ${app}
    Fortigate Forwarding Application Categories: ${appcat}
    Fortigate Forwarding Risk Levels: ${risk}
    Fortigate Forwarding Actions: ${utmaction}
    Fortigate Forwarding Destination OS Names: ${osname}
- comment:
  - 'FortiGate: Traffic Logs > Local Traffic'
  - 'Sample Log:'
  - 'date=2019-05-10 time=11:50:48 logid="0001000014" type="traffic" subtype="local" level="notice" vd="vdom1" eventtime=1557514248379911176 srcip=172.16.200.254 srcport=62024 srcintf="port11" srcintfrole="undefined" dstip=172.16.200.2 dstport=443 dstintf="vdom1" dstintfrole="undefined" sessionid=107478 proto=6 action="server-rst" policyid=0 policytype="local-in-policy" service="HTTPS" dstcountry="Reserved" srccountry="Reserved" trandisp="noop" app="Web Management(HTTPS)" duration=5 sentbyte=1247 rcvdbyte=1719 sentpkt=5 rcvdpkt=6 appcat="unscanned"'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0001
  rewrite:
    program: FortiGate Local Traffic
  tag:
    Fortigate Local Types: ${type}
    Fortigate Local SubTypes: ${subtype}
    Fortigate Local Source Interfaces: ${srcintf}
    Fortigate Local Source Interface Roles: ${srcintfrole}
    Fortigate Local Destination Interfaces: ${dstintf}
    Fortigate Local Destination Interface Roles: ${dstintfrole}
    Fortigate Local Actions: ${action}
    Fortigate Local Policy Types: ${policytype}
    Fortigate Local Services: ${service}
    Fortigate Local Applications: ${app}
    Fortigate Local Application Categories: ${appcat}
- comment:
  - 'FortiGate: Traffic Logs > Multicast Traffic'
  - 'Sample Log:'
  - 'date=2019-03-31 time=06:42:54 logid="0002000012" type="traffic" subtype="multicast" level="notice" vd="vdom1" eventtime=1554039772 srcip=172.16.200.55 srcport=60660 srcintf="port25" srcintfrole="undefined" dstip=230.1.1.2 dstport=7878 dstintf="port3" dstintfrole="undefined" sessionid=1162 proto=17 action="accept" policyid=1 policytype="multicast-policy" service="udp/7878" dstcountry="Reserved" srccountry="Reserved" trandisp="noop" duration=22 sentbyte=5940 rcvdbyte=0 sentpkt=11 rcvdpkt=0 appcat="unscanned"'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0002
  rewrite:
    program: FortiGate Multicast Traffic
  tag:
    Fortigate Multicast Types: ${type}
    Fortigate SubTypes: ${subtype}
    Fortigate Multicast Source Interfaces: ${srcintf}
    Fortigate Multicast Source Interface Roles: ${srcintfrole}
    Fortigate Multicast Destination Interfaces: ${dstintf}
    Fortigate Multicast Destination Interface Roles: ${dstintfrole}
    Fortigate Multicast Actions: ${action}
    Fortigate Multicast Policy Types: ${policytype}
    Fortigate Multicast Services: ${service}
    Fortigate Multicast Application Categories: ${appcat}
- comment:
  - 'FortiGate: Traffic Logs > Sniffer Traffic'
  - 'Sample Log:'
  - 'date=2019-05-10 time=14:18:54 logid="0004000017" type="traffic" subtype="sniffer" level="notice" vd="root" eventtime=1557523134021045897 srcip=208.91.114.4 srcport=50463 srcintf="port1" srcintfrole="undefined" dstip=104.80.88.154 dstport=443 dstintf="port1" dstintfrole="undefined" sessionid=2193276 proto=6 action="accept" policyid=3 policytype="sniffer" service="HTTPS" dstcountry="United States" srccountry="Canada" trandisp="snat" transip=0.0.0.0 transport=0 duration=10 sentbyte=0 rcvdbyte=0 sentpkt=0 rcvdpkt=0 appcat="unscanned" utmaction="allow" countips=1 crscore=5 craction=32768 sentdelta=0 rcvddelta=0 utmref=65162-7772'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0004
  rewrite:
    program: FortiGate Sniffer Traffic
  tag:
    Fortigate Sniffer Types: ${type}
    Fortigate Sniffer Multicast SubTypes: ${subtype}
    Fortigate Sniffer Source Interfaces: ${srcintf}
    Fortigate Sniffer Source Interface Roles: ${srcintfrole}
    Fortigate Sniffer Destination Interfaces: ${dstintf}
    Fortigate Sniffer Destination Interface Roles: ${dstintfrole}
    Fortigate Sniffer Actions: ${action}
    Fortigate Sniffer Policy Types: ${policytype}
    Fortigate Sniffer Services: ${service}
    Fortigate Sniffer Destination Countries: ${dstcountry}
    Fortigate Sniffer Source Countries: ${srccountry}
    Fortigate Sniffer Application Categories: ${appcat}
    Fortigate Sniffer UTM Actions: ${utmaction}
- comment:
  - 'FortiGate: Event Logs > System Events'
  - 'Sample Log:'
  - 'date=2019-05-13 time=11:20:54 logid="0100032001" type="event" subtype="system" level="information" vd="vdom1" eventtime=1557771654587081441 logdesc="Admin login successful" sn="1557771654" user="admin" ui="ssh(172.16.200.254)" method="ssh" srcip=172.16.200.254 dstip=172.16.200.2 action="login" status="success" reason="none" profile="super_admin" msg="Administrator admin logged in successfully from ssh(172.16.200.254)"'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0100
  rewrite:
    program: FortiGate System Events
  tag:
    Fortigate System Types: ${type}
    Fortigate System SubTypes: ${subtype}
    Fortigate System Descriptions: ${logdesc}
    Fortigate System Users: ${user}
    Fortigate System Methods: ${method}
    Fortigate System Actions: ${action}
    Fortigate System Profiles: ${super_admin}
- comment:
  - 'FortiGate: Event Logs > Router Events'
  - 'Sample Log:'
  - 'date=2019-05-13 time=14:12:26 logid="0103020301" type="event" subtype="router" level="warning" vd="root" eventtime=1557781946677737955 logdesc="Routing log" msg="OSPF: RECV[Hello]: From 31.1.1.1 via port9:172.16.200.1: Invalid Area ID 0.0.0.0"'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0103
  rewrite:
    program: FortiGate Router Events
  tag:
    Fortigate Router Types: ${type}
    Fortigate Router SubTypes: ${subtype}
    Fortigate Router Descriptions: ${logdesc}
- comment:
  - 'FortiGate: Event Logs > VPN Events'
  - 'Sample Log:'
  - 'date=2019-05-13 time=14:21:42 logid="0101037127" type="event" subtype="vpn" level="notice" vd="root" eventtime=1557782502722231889 logdesc="Progress IPsec phase 1" msg="progress IPsec phase 1" action="negotiate" remip=50.1.1.101 locip=50.1.1.100 remport=500 locport=500 outintf="port14" cookies="9091f4d4837ea71c/0000000000000000" user="N/A" group="N/A" xauthuser="N/A" xauthgroup="N/A" assignip=N/A vpntunnel="test" status="success" init="local" mode="main" dir="outbound" stage=1 role="initiator" result="OK"'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0101
  rewrite:
    program: FortiGate VPN Events
  tag:
    Fortigate VPN Types: ${type}
    Fortigate VPN SubTypes: ${subtype}
    Fortigate VPN Descriptions: ${logdesc}
    Fortigate VPN Actions: ${action}
    Fortigate VPN Outbound Interfaces: ${outintf}
    Fortigate VPN Tunnels: ${vpntunnel}
- comment:
  - 'FortiGate: Event Logs > User Events'
  - 'Sample Log:'
  - 'date=2019-05-13 time=15:55:56 logid="0102043008" type="event" subtype="user" level="notice" vd="root" eventtime=1557788156913809277 logdesc="Authentication success" srcip=10.1.100.11 dstip=172.16.200.55 policyid=1 interface="port10" user="bob" group="local-group1" authproto="TELNET(10.1.100.11)" action="authentication" status="success" reason="N/A" msg="User bob succeeded in authentication"'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0102
  rewrite:
    program: FortiGate User Events
  tag:
    Fortigate User Types: ${type}
    Fortigate User SubTypes: ${subtype}
    Fortigate User Descriptions: ${logdesc}
    Fortigate User Interfaces: ${interface}
    Fortigate User Names: ${user}
    Fortigate User Groups: ${group}
    Fortigate User Actions: ${action}
- comment:
  - 'FortiGate: Event Logs > Endpoint Events'
  - 'Sample Log:'
  - 'date=2019-05-14 time=08:32:13 logid="0107045057" type="event" subtype="endpoint" level="information" vd="root" eventtime=1557847933900764210 logdesc="FortiClient connection added" action="add" status="success" license_limit="unlimited" used_for_type=4 connection_type="sslvpn" count=1 user="skubas" ip=172.18.64.250 name="VAN-200957-PC" fctuid="52C66FE08F724FE0B116DAD5062C96CD" msg="Add a FortiClient Connection."'
  - 'Sample 2:'
  - 'date=2019-05-14 time=08:19:38 logid="0107045058" type="event" subtype="endpoint" level="information" vd="root" eventtime=1557847179037488154 logdesc="FortiClient connection closed" action="close" status="success" license_limit="unlimited" used_for_type=5 connection_type="sslvpn" count=1 user="skubas" ip=172.18.64.250 name="VAN-200957-PC" fctuid="52C66FE08F724FE0B116DAD5062C96CD" msg="Close a FortiClient Connection."'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0107
  rewrite:
    program: FortiGate Endpoint Events
  tag:
    Fortigate Endpoint Types: ${type}
    Fortigate Endpoint SubTypes: ${subtype}
    Fortigate Endpoint Descriptions: ${logdesc}
    Fortigate Endpoint Actions: ${action}
    Fortigate Endpoint Connection Types: ${connection_type}
    Fortigate Endpoint Users: ${user}
    Fortigate Endpoint Names: ${name}
- comment:
  - 'FortiGate: Event Logs > HA Events'
  - 'Sample Log:'
  - 'date=2019-05-10 time=09:53:21 logid="0108037892" type="event" subtype="ha" level="notice" vd="root" eventtime=1557507201608871077 logdesc="Virtual cluster member state moved" msg="Virtual clusters member state moved" ha_role="master" vcluster=1 vcluster_state="work" vcluster_member=0 hostname="FW_QA4" sn="FG2K5E3916900348"'
  - 'Sample 2:'
  - 'date=2019-05-10 time=09:53:18 logid="0108037894" type="event" subtype="ha" level="critical" vd="root" eventtime=1557507199208575235 logdesc="Virtual cluster member joined" msg="Virtual cluster detected member join" vcluster=1 ha_group=0 sn="FG2K5E3916900286"'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0108
  rewrite:
    program: FortiGate HA Events
  tag:
    Fortigate HA Types: ${type}
    Fortigate HA SubTypes: ${subtype}
    Fortigate HA Descriptions: ${logdesc}
    Fortigate HA Roles: ${ha_role}
    Fortigate HA Hostnames: ${hostname}
- comment:
  - 'FortiGate: Event Logs > Security Rating Events'
  - 'Sample Log:'
  - 'date=2019-05-13 time=14:40:59 logid="0110052000" type="event" subtype="security-rating" level="notice" vd="root" eventtime=1557783659536252389 logdesc="Security Rating summary" auditid=1557783648 audittime=1557783659 auditscore="5.0" criticalcount=1 highcount=6 mediumcount=8 lowcount=0 passedcount=38'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0110
  rewrite:
    program: FortiGate Security Rating Events
  tag:
    Fortigate Security Rating Types: ${type}
    Fortigate Security Rating SubTypes: ${subtype}
    Fortigate Security Rating Audit Scores: ${auditscore}
- comment:
  - 'FortiGate: Event Logs > WAN Opt & Cache Events'
  - 'Sample Log:'
  - 'date=2019-05-14 time=09:37:46 logid="0105048039" type="event" subtype="wad" level="error" vd="root" eventtime=1557851867382676560 logdesc="SSL fatal alert sent" session_id=0 policyid=0 srcip=0.0.0.0 srcport=0 dstip=208.91.113.83 dstport=636 action="send" alert="2" desc="certificate unknown" msg="SSL Alert sent"'
  - 'Sample 2:'
  - 'date=2019-05-10 time=15:48:31 logid="0105048038" type="event" subtype="wad" level="error" vd="root" eventtime=1557528511221374615 logdesc="SSL Fatal Alert received" session_id=5f88ddd1 policyid=0 srcip=172.18.70.15 srcport=59880 dstip=91.189.89.223 dstport=443 action="receive" alert="2" desc="unknown ca" msg="SSL Alert received"'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0105
  rewrite:
    program: FortiGate WAN Events
  tag:
    Fortigate WAN Types: ${type}
    Fortigate WAN SubTypes: ${subtype}
    Fortigate WAN Opt Descriptions: ${logdesc}
    Fortigate WAN Opt Actions: ${action}
    Fortigate WAN Opt Descriptions: ${desc}
- comment:
  - 'FortiGate: Event Logs > Wireless'
  - 'Sample Log:'
  - 'date=2019-05-13 time=11:30:08 logid="0104043568" type="event" subtype="wireless" level="warning" vd="vdom1" eventtime=1557772208134721423 logdesc="Fake AP on air" ssid="fortinet" bssid="90:6c:ac:89:e1:fa" aptype=0 rate=130 radioband="802.11n" channel=6 action="fake-ap-on-air" manuf="Fortinet, Inc." security="WPA2 Personal" encryption="AES" signal=-93 noise=-95 live=353938 age=505 onwire="no" detectionmethod="N/A" stamac="N/A" apscan="N/A" sndetected="N/A" radioiddetected=0 stacount=0 snclosest="FP320C3X17001909" radioidclosest=0 apstatus=0 msg="Fake AP On-air fortinet 90:6c:ac:89:e1:fa chan 6 live 353938 age 505"'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0104
  rewrite:
    program: FortiGate Wireless Events
  tag:
    Fortigate Wireless Types: ${type}
    Fortigate Wireless SubTypes: ${subtype}
    Fortigate Wireless Descriptions: ${logdesc}
    Fortigate Wireless SSIDs: ${ssid}
    Fortigate Wireless Bands: ${radioband}
    Fortigate Wireless Actions: ${action}
    Fortigate Wireless Manufacturers: ${manuf}
    Fortigate Wireless Security: ${security}
- comment:
  - 'FortiGate: Event Logs > SDN Connector'
  - 'Sample Log:'
  - 'date=2019-05-13 time=16:09:43 logid="0112053200" type="event" subtype="connector" level="information" vd="root" eventtime=1557788982 logdesc="IP address added" cfgobj="aws1" action="object-add" addr="54.210.36.196" cldobjid="i-0fe5a1ef16bb94796" netid="vpc-97e81cee" msg="connector object discovered in addr-obj aws1, 54.210.36.196"'
  - 'Sample 2:'
  - 'date=2019-05-13 time=16:09:43 logid="0112053201" type="event" subtype="connector" level="information" vd="root" eventtime=1557788982 logdesc="IP address removed" cfgobj="aws1" action="object-remove" addr="172.31.31.101" cldobjid="i-0fe5a1ef16bb94796" netid="vpc-97e81cee" msg="connector object removed in addr-obj aws1, 172.31.31.101"'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0112
  rewrite:
    program: FortiGate SDN Events
  tag:
    Fortigate SDN Types: ${type}
    Fortigate SDN SubTypes: ${subtype}
    Fortigate SDN Descriptions: ${logdesc}
    Fortigate SDN Actions: ${action}
- comment:
  - 'FortiGate: Event Logs > FortiExtender Events'
  - 'Sample Log:'
  - 'date=2019-02-20 time=09:57:22 logid="0111046400" type="event" subtype="fortiextender" level="notice" vd="root" eventtime=1550685442 logdesc="FortiExtender system activity"   action="FortiExtender Authorized"    msg="ext SN:FX04DN4N16002352 authorized"'
  - 'Sample 2:'
  - 'date=2019-02-20 time=10:02:26 logid="0111046409" type="event" subtype="fortiextender" level="information" vd="root" eventtime=1550685746 logdesc="Remote FortiExtender info activity" sn="FX04DN4N16002352" ip=11.11.11.2 action="Cellular Connected" imei="359376060442770" imsi="302720502331361" iccid="89302720403038146410" phonenumber="+16045067526" carrier="Rogers" plan="Rogers-plan" apn="N/A" service="LTE" msg="FX04DN4N16002352 STATE: sim with imsi:302720502331361 in slot:2 on carrier:Rogers connected"'
  - 'Sample 3:'
  - 'date=2019-02-20 time=10:33:57 logid="0111046407" type="event" subtype="fortiextender" level="warning" vd="root" eventtime=1550687636 logdesc="Remote FortiExtender warning activity" sn="FX04DN4N16002352" ip=11.11.11.2 action="Cellular Disconnected" imei="359376060442770" imsi="N/A" iccid="N/A" phonenumber="N/A" carrier="N/A" plan="N/A" apn="N/A" service="LTE" msg="FX04DN4N16002352 STATE: sim with imsi: in slot:2 on carrier:N/A disconnected"'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0111
  rewrite:
    program: FortiGate FortiExtender Events
  tag:
    Fortigate FortiExtender Types: ${type}
    Fortigate FortiExtender SubTypes: ${subtype}
    Fortigate FortiExtender Descriptions: ${logdesc}
    Fortigate FortiExtender Actions: ${action}
    Fortigate FortiExtender Carriers: ${carrier}
    Fortigate FortiExtender Plans: ${plan}
    Fortigate FortiExtender Services: ${service}
- comment:
  - 'FortiGate: Security Logs > Antivirus'
  - 'Sample Log:'
  - 'date=2019-05-13 time=11:45:03 logid="0211008192" type="utm" subtype="virus" eventtype="infected" level="warning" vd="vdom1" eventtime=1557773103767393505 msg="File is infected." action="blocked" service="HTTP" sessionid=359260 srcip=10.1.100.11 dstip=172.16.200.55 srcport=60446 dstport=80 srcintf="port12" srcintfrole="undefined" dstintf="port11" dstintfrole="undefined" policyid=4 proto=6 direction="incoming" filename="eicar.com" quarskip="File-was-not-quarantined." virus="EICAR_TEST_FILE" dtype="Virus" ref="http://www.fortinet.com/ve?vn=EICAR_TEST_FILE" virusid=2172 url="http://172.16.200.55/virus/eicar.com" profile="g-default" agent="curl/7.47.0" analyticscksum="275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f" analyticssubmit="false" crscore=50 craction=2 crlevel="critical"'
  - 'Corresponding Traffic Log:'
  - 'date=2019-05-13 time=11:45:04 logid="0000000013" type="traffic" subtype="forward" level="notice" vd="vdom1" eventtime=1557773104815101919 srcip=10.1.100.11 srcport=60446 srcintf="port12" srcintfrole="undefined" dstip=172.16.200.55 dstport=80 dstintf="port11" dstintfrole="undefined" srcuuid="48420c8a-5c88-51e9-0424-a37f9e74621e" dstuuid="187d6f46-5c86-51e9-70a0-fadcfc349c3e" poluuid="3888b41a-5c88-51e9-cb32-1c32c66b4edf" sessionid=359260 proto=6 action="close" policyid=4 policytype="policy" service="HTTP" dstcountry="Reserved" srccountry="Reserved" trandisp="snat" transip=172.16.200.2 transport=60446 appid=15893 app="HTTP.BROWSER" appcat="Web.Client" apprisk="medium" applist="g-default" duration=1 sentbyte=412 rcvdbyte=2286 sentpkt=6 rcvdpkt=6 wanin=313 wanout=92 lanin=92 lanout=92 utmaction="block" countav=1 countapp=1 crscore=50 craction=2 osname="Ubuntu" mastersrcmac="a2:e9:00:ec:40:01" srcmac="a2:e9:00:ec:40:01" srcserver=0 utmref=65497-770'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0211
  rewrite:
    program: FortiGate Antivirus
  tag:
    Fortigate Antivirus Types: ${type}
    Fortigate Antivirus SubTypes: ${subtype}
    Fortigate Antivirus Source Interfaces: ${srcintf}
    Fortigate Antivirus Source Interface Roles: ${srcintfrole}
    Fortigate Antivirus Destination Interfaces: ${dstintf}
    Fortigate Antivirus Destination Interface Roles: ${dstintfrole}
    Fortigate Antivirus Actions: ${action}
    Fortigate Antivirus Services: ${service}
    Fortigate Antivirus Destination Countries: ${dstcountry}
    Fortigate Antivirus Source Countries: ${srccountry}
    Fortigate Antivirus Applications: ${app}
    Fortigate Antivirus Application Categories: ${appcat}
    Fortigate Antivirus Risk Levels: ${apprisk}
    Fortigate Antivirus UTM Actions: ${utmaction}
    Fortigate Antivirus OS Names: ${osname}
- comment:
  - 'FortiGate: Security Logs > Web Filter'
  - 'Sample Log:'
  - 'date=2019-05-13 time=16:29:45 logid="0316013056" type="utm" subtype="webfilter" eventtype="ftgd_blk" level="warning" vd="vdom1" eventtime=1557790184975119738 policyid=1 sessionid=381780 srcip=10.1.100.11 srcport=44258 srcintf="port12" srcintfrole="undefined" dstip=185.244.31.158 dstport=80 dstintf="port11" dstintfrole="undefined" proto=6 service="HTTP" hostname="morrishittu.ddns.net" profile="test-webfilter" action="blocked" reqtype="direct" url="/" sentbyte=84 rcvdbyte=0 direction="outgoing" msg="URL belongs to a denied category in policy" method="domain" cat=26 catdesc="Malicious Websites" crscore=30 craction=4194304 crlevel="high"'
  - 'Corresponding Traffic Log:'
  - 'date=2019-05-13 time=16:29:50 logid="0000000013" type="traffic" subtype="forward" level="notice" vd="vdom1" eventtime=1557790190452146185 srcip=10.1.100.11 srcport=44258 srcintf="port12" srcintfrole="undefined" dstip=185.244.31.158 dstport=80 dstintf="port11" dstintfrole="undefined" srcuuid="ae28f494-5735-51e9-f247-d1d2ce663f4b" dstuuid="ae28f494-5735-51e9-f247-d1d2ce663f4b" poluuid="ccb269e0-5735-51e9-a218-a397dd08b7eb" sessionid=381780 proto=6 action="close" policyid=1 policytype="policy" service="HTTP" dstcountry="Germany" srccountry="Reserved" trandisp="snat" transip=172.16.200.2 transport=44258 duration=5 sentbyte=736 rcvdbyte=3138 sentpkt=14 rcvdpkt=5 appcat="unscanned" utmaction="block" countweb=1 crscore=30 craction=4194304 osname="Ubuntu" mastersrcmac="a2:e9:00:ec:40:01" srcmac="a2:e9:00:ec:40:01" srcserver=0 utmref=65497-796'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0316
  rewrite:
    program: FortiGate Web Filter
  tag:
    Fortigate Web Types: ${type}
    Fortigate Web SubTypes: ${subtype}
    Fortigate Web Event Types: ${eventtype}
    Fortigate Web Source Interfaces: ${srcintf}
    Fortigate Web Source Interface Roles: ${srcintfrole}
    Fortigate Web Destination Interfaces: ${dstintf}
    Fortigate Web Destination Interface Roles: ${dstintfrole}
    Fortigate Web Services: ${service}
    Fortigate Web Actions: ${action}
    Fortigate Web Methods: ${method}
    Fortigate Web Categories: ${catdesc}
- comment:
  - 'FortiGate: Security Logs > DNS Query'
  - 'Sample Log:'
  - 'date=2019-05-15 time=15:05:49 logid="1501054802" type="utm" subtype="dns" eventtype="dns-response" level="notice" vd="vdom1" eventtime=1557957949740931155 policyid=1 sessionid=6887 srcip=10.1.100.22 srcport=50002 srcintf="port12" srcintfrole="undefined" dstip=172.16.100.100 dstport=53 dstintf="port11" dstintfrole="undefined" proto=17 profile="dnsfilter_fgd" srcmac="a2:e9:00:ec:40:41" xid=57945 qname="changelogs.ubuntu.com" qtype="AAAA" qtypeval=28 qclass="IN" ipaddr="2001:67c:1560:8008::11" msg="Domain is monitored" action="pass" cat=52 catdesc="Information Technology"'
  - 'Corresponding Traffic Log:'
  - 'date=2019-05-15 time=15:08:49 logid="0000000013" type="traffic" subtype="forward" level="notice" vd="vdom1" eventtime=1557958129950003945 srcip=10.1.100.22 srcport=50002 srcintf="port12" srcintfrole="undefined" dstip=172.16.100.100 dstport=53 dstintf="port11" dstintfrole="undefined" srcuuid="ae28f494-5735-51e9-f247-d1d2ce663f4b" dstuuid="ae28f494-5735-51e9-f247-d1d2ce663f4b" poluuid="ccb269e0-5735-51e9-a218-a397dd08b7eb" sessionid=6887 proto=17 action="accept" policyid=1 policytype="policy" service="DNS" dstcountry="Reserved" srccountry="Reserved" trandisp="snat" transip=172.16.200.2 transport=50002 duration=180 sentbyte=67 rcvdbyte=207 sentpkt=1 rcvdpkt=1 appcat="unscanned" utmaction="allow" countdns=1 osname="Linux" mastersrcmac="a2:e9:00:ec:40:41" srcmac="a2:e9:00:ec:40:41" srcserver=0 utmref=65495-306'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="1501
  rewrite:
    program: FortiGate DNS Query
  tag:
    Fortigate DNS Types: ${type}
    Fortigate DNS SubTypes: ${subtype}
    Fortigate DNS Event Types: ${eventtype}
    Fortigate DNS Source Interfaces: ${srcintf}
    Fortigate DNS Source Interface Roles: ${srcintfrole}
    Fortigate DNS Destination Interfaces: ${dstintf}
    Fortigate DNS Destination Interface Roles: ${dstintfrole}
    Fortigate DNS Profiles: ${profile}
    Fortigate DNS Actions: ${action}
    Fortigate DNS Categories: ${catdesc}
- comment:
  - 'FortiGate: Security Logs > DNS Query'
  - 'Sample Log:'
  - 'date=2019-05-15 time=15:05:49 logid="1500054000" type="utm" subtype="dns" eventtype="dns-query" level="information" vd="vdom1" eventtime=1557957949653103543 policyid=1 sessionid=6887 srcip=10.1.100.22 srcport=50002 srcintf="port12" srcintfrole="undefined" dstip=172.16.100.100 dstport=53 dstintf="port11" dstintfrole="undefined" proto=17 profile="dnsfilter_fgd" srcmac="a2:e9:00:ec:40:41" xid=57945 qname="changelogs.ubuntu.com" qtype="AAAA" qtypeval=28 qclass="IN"'
  - 'Corresponding Traffic Log:'
  - 'date=2019-05-15 time=15:08:49 logid="0000000013" type="traffic" subtype="forward" level="notice" vd="vdom1" eventtime=1557958129950003945 srcip=10.1.100.22 srcport=50002 srcintf="port12" srcintfrole="undefined" dstip=172.16.100.100 dstport=53 dstintf="port11" dstintfrole="undefined" srcuuid="ae28f494-5735-51e9-f247-d1d2ce663f4b" dstuuid="ae28f494-5735-51e9-f247-d1d2ce663f4b" poluuid="ccb269e0-5735-51e9-a218-a397dd08b7eb" sessionid=6887 proto=17 action="accept" policyid=1 policytype="policy" service="DNS" dstcountry="Reserved" srccountry="Reserved" trandisp="snat" transip=172.16.200.2 transport=50002 duration=180 sentbyte=67 rcvdbyte=207 sentpkt=1 rcvdpkt=1 appcat="unscanned" utmaction="allow" countdns=1 osname="Linux" mastersrcmac="a2:e9:00:ec:40:41" srcmac="a2:e9:00:ec:40:41" srcserver=0 utmref=65495-306'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="1500
  rewrite:
    program: FortiGate DNS Query
  tag:
    Fortigate DNS Types: ${type}
    Fortigate DNS SubTypes: ${subtype}
    Fortigate DNS Event Types: ${eventtype}
    Fortigate DNS Source Interfaces: ${srcintf}
    Fortigate DNS Source Interface Roles: ${srcintfrole}
    Fortigate DNS Destination Interfaces: ${dstintf}
    Fortigate DNS Destination Interface Roles: ${dstintfrole}
    Fortigate DNS Profiles: ${profile}
    Fortigate DNS Actions: ${action}
- comment:
  - 'FortiGate: Security Logs > Application Control'
  - 'Sample Log:'
  - 'date=2019-05-15 time=18:03:36 logid="1059028704" type="utm" subtype="app-ctrl" eventtype="app-ctrl-all" level="information" vd="root" eventtime=1557968615 appid=40568 srcip=10.1.100.22 dstip=195.8.215.136 srcport=50798 dstport=443 srcintf="port10" srcintfrole="lan" dstintf="port9" dstintfrole="wan" proto=6 service="HTTPS" direction="outgoing" policyid=1 sessionid=4414 applist="block-social.media" appcat="Web.Client" app="HTTPS.BROWSER" action="pass" hostname="www.dailymotion.com" incidentserialno=1962906680 url="/" msg="Web.Client: HTTPS.BROWSER," apprisk="medium" scertcname="*.dailymotion.com" scertissuer="DigiCert SHA2 High Assurance Server CA"'
  - 'Corresponding Traffic Log:'
  - 'date=2019-05-15 time=18:03:41 logid="0000000013" type="traffic" subtype="forward" level="notice" vd="root" eventtime=1557968619 srcip=10.1.100.22 srcport=50798 srcintf="port10" srcintfrole="lan" dstip=195.8.215.136 dstport=443 dstintf="port9" dstintfrole="wan" poluuid="d8ce7a90-7763-51e9-e2be-741294c96f31" sessionid=4414 proto=6 action="client-rst" policyid=1 policytype="policy" service="HTTPS" dstcountry="France" srccountry="Reserved" trandisp="snat" transip=172.16.200.10 transport=50798 appid=16072 app="Dailymotion" appcat="Video/Audio" apprisk="elevated" applist="block-social.media" appact="drop-session" duration=5 sentbyte=1150 rcvdbyte=7039 sentpkt=13 utmaction="block" countapp=3 devtype="Unknown" devcategory="None" mastersrcmac="00:0c:29:51:38:5e" srcmac="00:0c:29:51:38:5e" srcserver=0 utmref=0-330'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="1059
  rewrite:
    program: FortiGate Application Control
  tag:
    Fortigate App Control Types: ${type}
    Fortigate App Control SubTypes: ${subtype}
    Fortigate App Control Event Types: ${eventtype}
    Fortigate App Control Source Interfaces: ${srcintf}
    Fortigate App Control Source Interface Roles: ${srcintfrole}
    Fortigate App Control Destination Interfaces: ${dstintf}
    Fortigate App Control Destination Interface Roles: ${dstintfrole}
    Fortigate App Control Services: ${service}
    Fortigate App Control Directions: ${direction}
    Fortigate App Control App Lists: ${applist}
    Fortigate App Control App Categories: ${appcat}
    Fortigate App Control Applications: ${app}
    Fortigate App Control Actions: ${action}
    Fortigate App Control Risks: ${apprisk}
- comment:
  - 'FortiGate: Security Logs > Intrusion Prevention'
  - 'Sample Log:'
  - 'date=2019-05-15 time=17:56:41 logid="0419016384" type="utm" subtype="ips" eventtype="signature" level="alert" vd="root" eventtime=1557968201 severity="critical" srcip=10.1.100.22 srccountry="Reserved" dstip=172.16.200.55 srcintf="port10" srcintfrole="lan" dstintf="port9" dstintfrole="wan" sessionid=4017 action="dropped" proto=6 service="HTTP" policyid=1 attack="Adobe.Flash.newfunction.Handling.Code.Execution" srcport=46810 dstport=80 hostname="172.16.200.55" url="/ips/sig1.pdf" direction="incoming" attackid=23305 profile="block-critical-ips" ref="http://www.fortinet.com/ids/VID23305" incidentserialno=582633933 msg="applications3: Adobe.Flash.newfunction.Handling.Code.Execution," crscore=50 craction=4096 crlevel="critical"'
  - 'Corresponding Traffic Log:'
  - 'date=2019-05-15 time=17:58:10 logid="0000000013" type="traffic" subtype="forward" level="notice" vd="root" eventtime=1557968289 srcip=10.1.100.22 srcport=46810 srcintf="port10" srcintfrole="lan" dstip=172.16.200.55 dstport=80 dstintf="port9" dstintfrole="wan" poluuid="d8ce7a90-7763-51e9-e2be-741294c96f31" sessionid=4017 proto=6 action="close" policyid=1 policytype="policy" service="HTTP" dstcountry="Reserved" srccountry="Reserved" trandisp="snat" transip=172.16.200.10 transport=46810 duration=89 sentbyte=565 rcvdbyte=9112 sentpkt=9 rcvdpkt=8 appcat="unscanned" utmaction="block" countips=1 crscore=50 craction=4096 devtype="Unknown" devcategory="None" mastersrcmac="00:0c:29:51:38:5e" srcmac="00:0c:29:51:38:5e" srcserver=0 utmref=0-302'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0419
  rewrite:
    program: FortiGate Intrusion Prevention
  tag:
    Fortigate Intrusion Prevention Types: ${type}
    Fortigate Intrusion Prevention SubTypes: ${subtype}
    Fortigate Intrusion Prevention Event Types: ${eventtype}
    Fortigate Intrusion Prevention Source Countries: ${srccountry}
    Fortigate Intrusion Prevention Source Interfaces: ${srcintf}
    Fortigate Intrusion Prevention Source Interface Roles: ${srcintfrole}
    Fortigate Intrusion Prevention Destination Interfaces: ${dstintf}
    Fortigate Intrusion Prevention Destination Interface Roles: ${dstintfrole}
    Fortigate Intrusion Prevention Actions: ${action}
    Fortigate Intrusion Prevention Services: ${service}
    Fortigate Intrusion Prevention Attacks: ${attack}
    Fortigate Intrusion Prevention Directions: ${direction}
    Fortigate Intrusion Prevention Profiles: ${profile}
- comment:
  - 'FortiGate: Security Logs > Anomaly'
  - 'Sample Log:'
  - 'date=2019-05-13 time=17:05:59 logid="0720018433" type="utm" subtype="anomaly" eventtype="anomaly" level="alert" vd="vdom1" eventtime=1557792359461869329 severity="critical" srcip=10.1.100.11 srccountry="Reserved" dstip=172.16.200.55 srcintf="port12" srcintfrole="undefined" sessionid=0 action="clear_session" proto=1 service="PING" count=1 attack="icmp_flood" icmpid="0x1474" icmptype="0x08" icmpcode="0x00" attackid=16777316 policyid=1 policytype="DoS-policy" ref="http://www.fortinet.com/ids/VID16777316" msg="anomaly: icmp_flood, 51 > threshold 50" crscore=50 craction=4096 crlevel="critical"'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0720
  rewrite:
    program: FortiGate Anomaly
  tag:
    Fortigate Anomaly Types: ${type}
    Fortigate SubTypes: ${subtype}
    Fortigate Anomaly Event Types: ${eventtype}
    Fortigate Anomaly Source Countries: ${srccountry}
    Fortigate Anomaly Source Interfaces: ${srcintf}
    Fortigate Anomaly Source Interface Roles: ${srcintfrole}
    Fortigate Anomaly Actions: ${action}
    Fortigate Anomaly Services: ${service}
    Fortigate Anomaly Attacks: ${attack}
    Fortigate Anomaly Policy Types: ${policy}
- comment:
  - 'FortiGate: Security Logs > Data Leak Prevention'
  - 'Sample Log:'
  - 'date=2019-05-15 time=17:45:30 logid="0954024576" type="utm" subtype="dlp" eventtype="dlp" level="warning" vd="root" eventtime=1557967528 filteridx=1 dlpextra="dlp-file-size11" filtertype="file-type" filtercat="file" severity="medium" policyid=1 sessionid=3423 epoch=1740880646 eventid=0 srcip=10.1.100.22 srcport=50354 srcintf="port10" srcintfrole="lan" dstip=52.216.177.83 dstport=443 dstintf="port9" dstintfrole="wan" proto=6 service="HTTPS" filetype="pdf" direction="incoming" action="block" hostname="fortinetweb.s3.amazonaws.com" url="/docs.fortinet.com/v2/attachments/be3d0e3d-4b62-11e9-94bf-00505692583a/FortiOS_6.2.0_Log_Reference.pdf" agent="Wget/1.17.1" filename="FortiOS_6.2.0_Log_Reference.pdf" filesize=16360 profile="dlp-file-type-test"'
  - 'Corresponding Traffic Log:'
  - 'date=2019-05-15 time=17:45:34 logid="0000000013" type="traffic" subtype="forward" level="notice" vd="root" eventtime=1557967534 srcip=10.1.100.22 srcport=50354 srcintf="port10" srcintfrole="lan" dstip=52.216.177.83 dstport=443 dstintf="port9" dstintfrole="wan" poluuid="d8ce7a90-7763-51e9-e2be-741294c96f31" sessionid=3423 proto=6 action="server-rst" policyid=1 policytype="policy" service="HTTPS" dstcountry="United States" srccountry="Reserved" trandisp="snat" transip=172.16.200.10 transport=50354 duration=5 sentbyte=2314 rcvdbyte=5266 sentpkt=33 rcvdpkt=12 appcat="unscanned" wanin=43936 wanout=710 lanin=753 lanout=753 utmaction="block" countdlp=1 crscore=5 craction=262144 crlevel="low" devtype="Unknown" devcategory="None" mastersrcmac="00:0c:29:51:38:5e" srcmac="00:0c:29:51:38:5e" srcserver=0 utmref=0-152'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="0954
  rewrite:
    program: FortiGate Data Leak Prevention
  tag:
    Fortigate Data Leak Types: ${type}
    Fortigate Data Leak SubTypes: ${subtype}
    Fortigate Data Leak Event Types: ${eventtype}
    Fortigate Data Leak Filter Types: ${filtertype}
    Fortigate Data Leak Filter Categories: ${filtercat}
    Fortigate Data Leak Severities: ${severity}
    Fortigate Data Leak Source Interfaces: ${srcintf}
    Fortigate Data Leak Source Interface Roles: ${srcintfrole}
    Fortigate Data Leak Destination Interfaces: ${dstintf}
    Fortigate Data Leak Destination Interface Roles: ${dstintfrole}
    Fortigate Data Leak Policy Types: ${policy}
    Fortigate Data Leak Services: ${service}
    Fortigate Data Leak Source Countries: ${srccountry}
    Fortigate Data Leak Destination Countries: ${dstcountry}
    Fortigate Data Leak App Categeories: ${appcat}
    Fortigate Data Leak UTM Actions: ${utmaction}
- comment:
  - 'FortiGate: Security Logs > SSH'
  - 'Sample Log:'
  - 'date=2019-05-15 time=16:18:17 logid="1601061010" type="utm" subtype="ssh" eventtype="ssh-channel" level="warning" vd="vdom1" eventtime=1557962296 policyid=1 sessionid=344 profile="ssh-deepscan" srcip=10.1.100.11 srcport=43580 dstip=172.16.200.44 dstport=22 srcintf="port21" srcintfrole="undefined" dstintf="port23" dstintfrole="undefined" proto=6 action="blocked" direction="outgoing" login="root" channeltype="shell"'
  - 'Corresponding Traffic Log:'
  - 'date=2019-05-15 time=16:18:18 logid="0000000013" type="traffic" subtype="forward" level="notice" vd="vdom1" eventtime=1557962298 srcip=10.1.100.11 srcport=43580 srcintf="port21" srcintfrole="undefined" dstip=172.16.200.44 dstport=22 dstintf="port23" dstintfrole="undefined" poluuid="49871fae-7371-51e9-17b4-43c7ff119195" sessionid=344 proto=6 action="close" policyid=1 policytype="policy" service="SSH" dstcountry="Reserved" srccountry="Reserved" trandisp="snat" transip=172.16.200.171 transport=43580 duration=8 sentbyte=3093 rcvdbyte=2973 sentpkt=18 rcvdpkt=16 appcat="unscanned" utmaction="block" countssh=1 utmref=65535-0'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="1601
  rewrite:
    program: FortiGate SSH
  tag:
    Fortigate UTM SSH Types: ${type}
    Fortigate UTM SSH SubTypes: ${subtype}
    Fortigate UTM SSH Event Types: ${eventtype}
    Fortigate UTM SSH Profiles: ${profile}
    Fortigate UTM SSH Source Interfaces: ${srcintf}
    Fortigate UTM SSH Source Interface Roles: ${srcintfrole}
    Fortigate UTM SSH Destination Interfaces: ${dstintf}
    Fortigate UTM SSH Destination Interface Roles: ${dstintfrole}
    Fortigate UTM SSH Actions: ${action}
    Fortigate UTM SSH Directions: ${direction}
    Fortigate UTM SSH Logins: ${login}
    Fortigate UTM SSH Channel Types: ${channeltype}
- comment:
  - 'FortiGate: Security Logs > SSL Anomalies'
  - 'Sample Log:'
  - 'date=2019-03-28 time=10:44:53 logid="1700062002" type="utm" subtype="ssl" eventtype="ssl-anomalies" level="warning" vd="vdom1" eventtime=1553795092 policyid=1 sessionid=10796 service="HTTPS" srcip=10.1.100.66 srcport=43602 dstip=104.154.89.105 dstport=443 srcintf="port2" srcintfrole="undefined" dstintf="port3" dstintfrole="undefined" proto=6 action="blocked" msg="Server certificate blocked" '
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="1700
  rewrite:
    program: FortiGate SSL
  tag:
    Fortigate UTM SSL Types: ${type}
    Fortigate UTM SSL SubTypes: ${subtype}
    Fortigate UTM SSL Event Types: ${eventtype}
    Fortigate UTM SSL Services: ${service}
    Fortigate UTM SSL Source Interfaces: ${srcintf}
    Fortigate UTM SSL Source Interface Roles: ${srcintfrole}
    Fortigate UTM SSL Destination Interfaces: ${dstintf}
    Fortigate UTM SSL Destination Interface Roles: ${dstintfrole}
    Fortigate UTM SSL Actions: ${action}
- comment:
  - 'FortiGate: Security Logs > SSL Anomalies'
  - 'Sample Log:'
  - 'date=2019-03-28 time=11:06:05 logid="1701062003" type="utm" subtype="ssl" eventtype="ssl-exempt" level="notice" vd="vdom1" eventtime=1553796363 policyid=1 sessionid=11871 service="HTTPS" srcip=10.1.100.66 srcport=47384 dstip=50.18.221.132 dstport=443 srcintf="port2" srcintfrole="undefined" dstintf="port3" dstintfrole="undefined" proto=6 action="exempt" msg="SSL connection exempted" '
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="1701
  rewrite:
    program: FortiGate SSL
  tag:
    Fortigate UTM SSL Types: ${type}
    Fortigate UTM SSL SubTypes: ${subtype}
    Fortigate UTM SSL Event Types: ${eventtype}
    Fortigate UTM SSL Services: ${service}
    Fortigate UTM SSL Source Interfaces: ${srcintf}
    Fortigate UTM SSL Source Interface Roles: ${srcintfrole}
    Fortigate UTM SSL Destination Interfaces: ${dstintf}
    Fortigate UTM SSL Destination Interface Roles: ${dstintfrole}
    Fortigate UTM SSL Actions: ${action}
- comment:
  - 'FortiGate: Security Logs > CIFS'
  - 'Sample Log:'
  - 'date=2019-05-15 time=16:28:17 logid="1800063000" type="utm" subtype="cifs" eventtype="cifs-filefilter" level="warning" vd="vdom1" eventtime=1557962895 msg="File was blocked by file filter." direction="incoming" action="blocked" service="CIFS" srcip=10.1.100.11 dstip=172.16.200.44 srcport=56348 dstport=445 srcintf="port21" srcintfrole="undefined" dstintf="port23" dstintfrole="undefined" policyid=1 proto=16 profile="cifs" filesize="13824" filename="sample\\test.xls" filtername="1" filetype="msoffice"'
  - 'Category: Security'
  match:
    field: message
    op: =*
    value: logid="1800
  rewrite:
    program: FortiGate CIFS
  tag:
    Fortigate CIFS Types: ${type}
    Fortigate CIFS SubTypes: ${subtype}
    Fortigate CIFS Event Types: ${eventtype}
    Fortigate CIFS Directions: ${direction}
    Fortigate CIFS Actions: ${action}
    Fortigate CIFS Services: ${service}
    Fortigate CIFS Source Interfaces: ${srcintf}
    Fortigate CIFS Source Interface Roles: ${srcintfrole}
    Fortigate CIFS Destination Interfaces: ${dstintf}
    Fortigate CIFS Destination Interface Roles: ${dstintfrole}
    Fortigate CIFS File Types: ${filetype}
