rewrite_rules:
- comment:
  - 'Description: Strip TS from events, we do not need them'
  - 'Sample 1: 2019-08-15 23:21:51,776 foo bar baz'
  - 'Sample 2: 2019-08-15 23:21:51.776 foo bar baz'
  match:
    field: message
    op: =~
    value: ^\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2}.\d{3,4}\s+(.*)
  rewrite:
    message: $1
- comment:
  - 'Description: Strip TS from events, we do not need them'
  - 'Sample 1: 2019-08-15T23:50:46.712-0400:'
  match:
    field: message
    op: =~
    value: ^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+-\d+:\s+(.*)
  rewrite:
    message: $1
- comment:
  - 'Description: Clean Cisco ISE Timestamps'
  - 'Sample 1: 0002058297 1 0 2019-08-22 20:17:51.402 -05:00 0081789281 34140 WARN '
  - 'Regex test: https://regex101.com/r/2Acgy0/3'
  match:
    field: message
    op: =~
    value: ^\d{10}\s+\d+\s+\d+\s+\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2}.\d{3,4}\s+\S+\s+\d+\s+\d+ \S+\s+(.*)
  rewrite:
    message: $1
