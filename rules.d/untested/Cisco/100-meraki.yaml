rewrite_rules:
- comment: 'Meraki Events'
  match:
  - field: message
    op: =~
    value: \d{10}\.\d{9} (MX\d+) (\S+) (.*)
  kv:
    delimiter: ''
    separator: '='
  tag:
    ut_cisco_meraki_dst_ips: ${dst}
    ut_dst_port: ${dport}
    ut_cisco_meraki_protocols: ${protocol}
    ut_cisco_meraki_src_ips: ${src}
    ut_src_port: ${sport}
    ut_cisco_meraki_types: ${type}
    ut_cisco_meraki_patterns: ${pattern}
    ut_tmp: ${user}
  update:
    program: Meraki_$2
    message: $1 $2 $3
- comment: 'Meraki AD Users'
  match:
  - field: ut_tmp
    op: =~
    value: .+user=CN=(\S+),OU.+
  tag:
    ut_cisco_meraki_users: ${1}
