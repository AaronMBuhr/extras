{"rewrite_rules":[{"comment":["If it does not have a DeviceID (or is tagged 'null-meta'), then it's a branch site","This rule will strip off the extraneous meta tags added by syslog-ng from the"," message and restore the original message from the device"," for events which we don't care about adding this meta to"],"match":{"field":"message","op":"=~","value":["(.*?) -- META: DeviceID=\"\"","(.*?) -- META: DeviceID=\"null-meta\""]},"update":{"message":"$1"},"tag":{"ut_metadata_branch_devices":"$HOST","ut_metadata_roles":"Branch"}},{"comment":["strip empty VRF tag"],"match":{"field":"message","op":"=~","value":"(.*?) DeviceVRF=\"\" (.*)"},"update":{"message":"$1 $2"}},{"comment":["strip empty DeviceWAN tag"],"match":{"field":"message","op":"=~","value":"(.*?) DeviceWAN=\"\" (.*)"},"update":{"message":"$1 $2"}},{"comment":["If the event contains the same interface name as the meta tag's 'DeviceWAN' key, that means it is a wan interface","The RegEx below simply says 'look for an identical match to the previously captured match'","Thus, if my event is something like 'DeviceWAN=\"Gig1/0\" blah blah GigE1/0', then we have a winner","Upon matching, add new meta tags indicating that this is a Datacenter Device and it is a Wan Interface, so it this as an 'actionable' event"],"match":{"field":"message","op":"=~","value":".*DeviceWAN=\"([^\"]+)\" (.+\\1)(.*)"},"update":{"message":"isWAN=\"yes\" $MESSAGE"},"tag":{"ut_metadata_dc_wan":"$HOST","ut_metadata_roles":"DC"}},{"comment":["Grab meta injected from syslog-ng"],"match":{"field":"message","op":"=*","value":"DeviceID="},"tag":{"ut_metadata_ids":"${DeviceID}","ut_metadata_descriptions":"${DeviceDescription}","ut_metadata_importance":"${DeviceImportance}","ut_metadata_locations":"${DeviceLocation}","ut_metadata_layers":"${DeviceLayer}","ut_metadata_wan_interfaces":"${DeviceWAN}","ut_metadata_roles":"${DeviceRole}","ut_metadata_vrf":"${DeviceVRF}"}}]}
