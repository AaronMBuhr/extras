{
  "rewrite_rules": [
    {
      "comment": [
        "Sample: IPv4 source route attack from 10.0.1.34 detected.",
        "Description: IPv4 source route attack was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0152\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: SYN flood attack against 10.0.1.51 from 216.3.21.4 detected.",
        "Description: IPv4 SYN flood attack was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0153\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}",
        "ut_watchguard_dst": "${dst}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: ICMP flood attack against 10.0.1.51 from 216.3.21.4 detected.",
        "Description: IPv4 ICMP flood attack was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0154\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}",
        "ut_watchguard_dst": "${dst}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: UDP flood attack against 32.21.56.8 from 12.34.23.67 detected.",
        "Description: IPv4 UDP flood attack was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0155\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}",
        "ut_watchguard_dst": "${dst}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: IPSEC flood attack against 32.21.56.8 from 12.34.23.67 detected.",
        "Description: IPv4 IPSEC flood attack was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0156\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: IKE flood attack against 32.21.56.8 from 12.34.23.67 detected.",
        "Description: IPv4 IKE flood attack was detected"
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0157\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}",
        "ut_watchguard_dst": "${dst}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: IP scan attack against 32.21.56.8 from 12.34.23.67 detected.",
        "Description: IPv4 scan attack was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0158\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}",
        "ut_watchguard_dst": "${dst}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: PORT scan attack against 32.21.56.8 from 12.34.23.67 detected.",
        "Description: IPv4 port scan attack was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0159\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}",
        "ut_watchguard_dst": "${dst}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: DDOS against server 10.0.1.34 detected.",
        "Description: IPv4 DDOS attack against a server was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0160\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_dst": "${dst}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: DDOS from client 10.0.1.34 detected.",
        "Description: IPv4 DDOS attack from a client was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0161\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: SYN flood attack against 2001:0db8:85a3:08d3:1319:8a2e:0370:7344 from FF01::101 detected.",
        "Description: IPv6 SYN flood attack was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0162\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}",
        "ut_watchguard_dst": "${dst}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: ICMP flood attack against 2001:0db8:85a3:08d3:1319:8a2e:0370:7344 from FF01::101 detected.",
        "Description: IPv6 ICMP flood attack was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0163\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}",
        "ut_watchguard_dst": "${dst}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: UDP flood attack against 2001:0db8:85a3:08d3:1319:8a2e:0370:7344 from FF01::101 detected.",
        "Description: IPv6 UDP flood attack was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0164\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}",
        "ut_watchguard_dst": "${dst}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: IPSEC flood attack against 2001:0db8:85a3:08d3:1319:8a2e:0370:7344 from FF01::101 detected.",
        "Description: IPv6 IPSEC flood attack was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0165\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}",
        "ut_watchguard_dst": "${dst}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: IPSEC flood attack against 2001:0db8:85a3:08d3:1319:8a2e:0370:7344 from FF01::101 detected.",
        "Description: IPv6 IPSEC flood attack was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0165\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}",
        "ut_watchguard_dst": "${dst}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: IKE flood attack against 2001:0db8:85a3:08d3:1319:8a2e:0370:7344 from FF01::101 detected.",
        "Description: IPv6 IKE flood attack was detected."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0166\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src": "${src}",
        "ut_watchguard_dst": "${dst}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Policy Name: HTTP-00 Source IP Address: 10.0.1.20 Source Port: 4107 Destination IP Address: 61.135.169.125 Destination Port: 80",
        "Description: An alarm log message was sent for traffic that matched the specified policy."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0167\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src_ip": "${src_ip}",
        "ut_watchguard_dst_ip": "${dst_ip}",
        "ut_watchguard_src_port": "${src_port}",
        "ut_watchguard_dst_port": "${dst_port}",
        "ut_watchguard_pcy_name": "${pcy_name}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Policy Name: HTTP-00 Source IP Address: 10.0.1.20 Source Port: 4107 Destination IP Address: 61.135.169.125 Destination Port: 80",
        "Description: An alarm log message was sent for traffic that matched the specified policy."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0167\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src_ip": "${src_ip}",
        "ut_watchguard_dst_ip": "${dst_ip}",
        "ut_watchguard_src_port": "${src_port}",
        "ut_watchguard_dst_port": "${dst_port}",
        "ut_watchguard_pcy_name": "${pcy_name}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Blocked site: Traffic detected from 10.0.1.2 to 61.231.45.165.",
        "Description: Traffic was detected to or from a blocked site."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0168\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_dst": "${dst}",
        "ut_watchguard_src": "${src}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: IP spoofing: Traffic detected from 10.0.1.2 to 43.123.12.26.",
        "Description: IP spoofing was detected from the IP address specified in the log message."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0169\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_dst": "${dst}",
        "ut_watchguard_src": "${src}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: The number of connections (%u) has reached the configured limit (%d).",
        "Description: The conntrack table is full. The number of connections has reached the configured limit."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0171\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_value1": "${value1}",
        "ut_watchguard_value2": "${value2}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Blocked port: Traffic detected from %src to %dst on port %port.",
        "Description: Traffic was detected on a blocked port."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0172\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_dst": "${dst}",
        "ut_watchguard_src": "${src}",
        "ut_watchguard_port": "${port}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Application control settings updated",
        "Description: Firewall settings for the feature specified in the message have been updated"
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0006\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Deferred DNS forwarding until valid DNS server IP address is dynamically learned",
        "Description: \"DNS server IP address is not yet known, device will enable DNS when a DNS server IP address is detected\""
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0007\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Firewall is starting up",
        "Description: Firewall is starting up"
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0027\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Firewall is shutting down",
        "Description: Firewall is shutting down"
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0028\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: IP address 192.168.111.254 will not be added to the blocked sites list because it is exempt",
        "Description: The particular IP address is an exemption and will not be added to the blocked sites list"
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0029\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Idle timeout has occurred for blocked site 192.168.111.10",
        "Description: \"Idle timeout has occurred for the specified blocked site, and it will be removed from the blocked sites list.\""
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0040\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": "Sample: UserJames@Firebox-DBused 21 MB of the bandwidth quota (100 MB) and used 1 minute of the time quota (3 minutes).",
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0065\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": "Sample: IP address 192.168.111.10 will not be added to the blocked sites list because it already exists.",
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-002A\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: \"Unable to read the feature keys, some features may be unavailable\"",
        "Description: Unable to read feature keys file or fail to parse feature keys file. Features that require a correct feature key will not function."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-003A\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: \"Route look up on HTTP redirect host192.168.111.10for policy\"FTP-00\"failed, local redirect may not work\"",
        "Description: \"Route look up on HTTP redirect host for the specified policy failed, and local HTTP redirect may not work.\""
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-003C\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Verify ARP entry for host at 192.168.111.10",
        "Description: The appliance sent an ARP request to verify learned ARP entry for a given host."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-012D\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: \"Cannot relearn system MAC address, possible loop or MAC spoofing, ip=192.168.111.10, mac=00:50:da:c7:90:5d, interface=5\"",
        "Description: \"The appliance received an ARP packet sent from one of its own MAC addresses. It is possibly a network or cabling loop, or another device is faking this device's MAC address.\""
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-012E\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_interface": "${interface}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: The Application Control feature has expired.",
        "Description: The feature key for your Application Control subscription has expired."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0004\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: The IPS feature has expired.",
        "Description: The feature key for your Intrusion Prevention Services subscription has expired."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0005\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Temporarily blocking host198.13.111.226",
        "Description: The host is blocked temporarily."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3001-1001\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Feature key does not support the feature Policy based routing.",
        "Description: The device feature key does not support the specified feature."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-002F\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: \"TCP probe packets timeout, Load Balance Server 10.10.10.100 port 3030 is offline.\"",
        "Description: Load Balance Server status update due to response or lack of response to a TCP Probe packet. The log message specifies the server IP address and port."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-00C9\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_status": "${status}",
        "ut_watchguard_probe method": "${probe method}",
        "ut_watchguard_port": "${port}",
        "ut_watchguard_reason": "${reason}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: \"ICMP probe packets timeout, Load Balance Server 10.10.10.100 is offline.\"",
        "Description: Update to status of Load Balance Server due to success or failure of ICMP Probe packet. The log message specifies the server IP and status."
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-00CB\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_status": "${status}",
        "ut_watchguard_probe method": "${probe method}",
        "ut_watchguard_reason": "${reason}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: \"ARP spoofing attack detected, ip=192.168.111.10, mac=00:50:da:c7:90:5d, interface=5\"",
        "Description: \"Detected an ARP spoofing attack. The log message specifies the source IP address, MAC address, and incoming interface of the ARP packet.\""
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-012C\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_interface": "${interface}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Details of normal traffic either allowed or denied by the firewall policy specified in the log message.",
        "Description: Allow Firebox 0-External 52 tcp 20 127 10.0.1.2 206.190.60.138 62443 80 offset 8 S 832026162 win 8192 (HTTP-00)"
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0148\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_route_type": "${route_type}",
        "ut_watchguard_src_ip": "${src_ip}",
        "ut_watchguard_dns_query_dest": "${question}",
        "ut_watchguard_fqdn_dst_match": "${fqdn_dst_match}",
        "ut_watchguard_outif": "${outif}",
        "ut_watchguard_policy_name": "${policy_name}",
        "ut_watchguard_disposition": "${disposition}",
        "ut_watchguard_src_user": "${src_user}",
        "ut_watchguard_icmp_info": "${icmp_info}",
        "ut_watchguard_dst_user": "${dst_user}",
        "ut_watchguard_protocol": "${protocol}",
        "ut_watchguard_dst_ip": "${dst_ip}",
        "ut_watchguard_inif": "${inif}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Application Control identified traffic for an application.",
        "Description: \"Allow 1-Trusted 0-External 40 tcp 20 127 10.0.1.2 206.190.60.138 53008 80 offset 5 AF 3212213617 win 257 app_name=\"World Wide Web HTTP\" cat_name=\"Network Protocols\" app_beh_name=\"connect\" app_id=\"63\" app_cat_id=\"18\" app_ctl_disp=\"2\" msg=\"Application identified\" (HTTP-00)\""
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0149\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_route_type": "${route_type}",
        "ut_watchguard_app_ctl_disp": "${app_ctl_disp}",
        "ut_watchguard_src_ip": "${src_ip}",
        "ut_watchguard_app_beh_name": "${app_beh_name}",
        "ut_watchguard_outif": "${outif}",
        "ut_watchguard_policy_name": "${policy_name}",
        "ut_watchguard_disposition": "${disposition}",
        "ut_watchguard_app_name": "${app_name}",
        "ut_watchguard_src_user": "${src_user}",
        "ut_watchguard_protocol": "${protocol}",
        "ut_watchguard_dst_user": "${dst_user}",
        "ut_watchguard_cat_name": "${cat_name}",
        "ut_watchguard_inif": "${inif}",
        "ut_watchguard_dst_ip": "${dst_ip}",
        "ut_watchguard_msg": "${msg}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: IPS detected traffic that matches an IPS signature.",
        "Description: \"Deny 1-Trusted 0-External 1440 tcp 20 61 10.0.1.2 192.168.130.126 55810 80 offset 5 A 447868619 win 54 signature_name=\"EXPLOIT Apple QuickTime FLIC Animation file buffer overflow -1-2\" signature_cat=\"Misc\" signature_id=\"1112464\" severity=\"4\" msg=\"IPS detected\" (HTTP-00)\""
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0150\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_route_type": "${route_type}",
        "ut_watchguard_signature_cat": "${signature_cat}",
        "ut_watchguard_src_ip": "${src_ip}",
        "ut_watchguard_outif": "${outif}",
        "ut_watchguard_severity": "${severity}",
        "ut_watchguard_policy_name": "${policy_name}",
        "ut_watchguard_disposition": "${disposition}",
        "ut_watchguard_signature_name": "${signature_name}",
        "ut_watchguard_src_user": "${src_user}",
        "ut_watchguard_protocol": "${protocol}",
        "ut_watchguard_dst_user": "${dst_user}",
        "ut_watchguard_inif": "${inif}",
        "ut_watchguard_dst_ip": "${dst_ip}",
        "ut_watchguard_msg": "${msg}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Record for a terminated connection",
        "Description: \"Allow 1-Trusted 0-External tcp 10.0.1.2 220.181.90.24 53018 80 app_id=\"63\" app_cat_id=\"18\" app_ctl_disp=\"2\" duration=\"80\" sent_bytes=\"652\" rcvd_bytes=\"423\" (HTTP-00)\""
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0151\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_app_ctl_disp": "${app_ctl_disp}",
        "ut_watchguard_src_ip": "${src_ip}",
        "ut_watchguard_outif": "${outif}",
        "ut_watchguard_policy_name": "${policy_name}",
        "ut_watchguard_disposition": "${disposition}",
        "ut_watchguard_src_user": "${src_user}",
        "ut_watchguard_protocol": "${protocol}",
        "ut_watchguard_dst_user": "${dst_user}",
        "ut_watchguard_inif": "${inif}",
        "ut_watchguard_dst_ip": "${dst_ip}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": [
        "Sample: Details of hostile traffic denied by the firewall internal policy.",
        "Description: Deny 0-External Firebox 52 tcp 20 127 206.190.60.138 10.0.0.1 62443 80 offset 8 S 832026162 win 8192 blocked sites (Internal Policy)"
      ],
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "msg_id=\"3000-0173\"",
          "op": "=*",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src_ip": "${src_ip}",
        "ut_watchguard_outif": "${outif}",
        "ut_watchguard_src_user": "${src_user}",
        "ut_watchguard_protocol": "${protocol}",
        "ut_watchguard_dst_user": "${dst_user}",
        "ut_watchguard_icmp_info": "${icmp_info}",
        "ut_watchguard_inif": "${inif}",
        "ut_watchguard_dst_ip": "${dst_ip}"
      },
      "update": {
        "program": "WatchGuard_Firewall"
      }
    },
    {
      "comment": "Track Denied Sites",
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "Deny.+cats=\\S+ .+dstname",
          "op": "=~",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_denied_urls_src_dst_pairs": "${cats}: ${src} -> ${dst}:${dstPort}",
        "ut_watchguard_denied_urls_categories": "${cats}",
        "ut_watchguard_denied_urls": "${dstname}"
      }
    },
    {
      "comment": "Track Denied Applications",
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "disp.?=\"?Deny.+app=\\S+ .+app_cat=\\S+",
          "op": "=~",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_denied_appname_src_dst_port": "${app}: ${src} -> ${dst}:${dstPort}",
        "ut_watchguard_denied_app_categories": "${app_cat}",
        "ut_watchguard_denied_apps": "${app}"
      }
    },
    {
      "comment": "Track Allowed Applications",
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "disp.?=\"?Allow.+app=\\S+ .+app_cat=\\S+",
          "op": "=~",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_allowed_apps": "${app}",
        "ut_watchguard_allowed_apps_categories": "${app_cat}",
        "ut_watchguard_allowed_appname_src_dst_port": "${app}: ${src} -> ${dst}:${dstPort}"
      }
    },
    {
      "comment": "If we have both src and dst, create a new pair",
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "src=\\S+ .+dst\"?=\\S+",
          "op": "=~",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_src_dst_pairs": "${src}->${dst}"
      }
    },
    {
      "comment": "Track Allow/Deny",
      "match": [
        {
          "value": "firewall",
          "field": "program"
        },
        {
          "value": "(Allow|Deny)",
          "op": "=~",
          "field": "message"
        }
      ],
      "tag": {
        "ut_watchguard_allowed_apps_categories": "${app_cat}",
        "ut_watchguard_allowed_appname_src_dst_port": "${app}: ${src} -> ${dst}:${dstPort}",
        "ut_watchguard_allow_deny": "${1}"
      }
    }
  ],
  "first_match_only": true
}
